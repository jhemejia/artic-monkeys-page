// Arctic Monkeys Tours Data
const toursData = {
  events: [
    {
      month: "August 2025",
      events: [
        {
          day: "05",
          month: "Aug",
          title: "Arctic Monkeys in Mexico City",
          location: "Palacio de los Deportes, Mexico City, Mexico",
          dateFull: "Tuesday, August 5, 2025",
          ticketStatus: "sold-out",
          ticketUrl: "#",
        },
        {
          day: "12",
          month: "Aug",
          title: "Arctic Monkeys in São Paulo",
          location: "Allianz Parque, São Paulo, Brazil",
          dateFull: "Tuesday, August 12, 2025",
          ticketStatus: "sold-out",
          ticketUrl: "#",
        },
        {
          day: "20",
          month: "Aug",
          title: "Arctic Monkeys in Buenos Aires",
          location: "Movistar Arena, Buenos Aires, Argentina",
          dateFull: "Wednesday, August 20, 2025",
          ticketStatus: "sold-out",
          ticketUrl: null,
        },
        {
          day: "28",
          month: "Aug",
          title: "Arctic Monkeys in Santiago",
          location: "Movistar Arena, Santiago, Chile",
          dateFull: "Thursday, August 28, 2025",
          ticketStatus: "sold-out",
          ticketUrl: "#",
        },
      ],
    },
    {
      month: "September 2025",
      events: [
        {
          day: "05",
          month: "Sep",
          title: "Arctic Monkeys in Tokyo",
          location: "Tokyo Dome, Tokyo, Japan",
          dateFull: "Friday, September 5, 2025",
          ticketStatus: "sold-out",
          ticketUrl: "#",
        },
        {
          day: "12",
          month: "Sep",
          title: "Arctic Monkeys in Seoul",
          location: "KSPO Dome, Seoul, South Korea",
          dateFull: "Friday, September 12, 2025",
          ticketStatus: "sold-out",
          ticketUrl: "#",
        },
        {
          day: "20",
          month: "Sep",
          title: "Arctic Monkeys in Singapore",
          location: "Singapore Indoor Stadium, Singapore",
          dateFull: "Saturday, September 20, 2025",
          ticketStatus: "sold-out",
          ticketUrl: null,
        },
        {
          day: "28",
          month: "Sep",
          title: "Arctic Monkeys in Melbourne",
          location: "Rod Laver Arena, Melbourne, Australia",
          dateFull: "Sunday, September 28, 2025",
          ticketStatus: "sold-out",
          ticketUrl: "#",
        },
      ],
    },
    {
      month: "October 2025",
      events: [
        {
          day: "05",
          month: "Oct",
          title: "Arctic Monkeys in Sydney",
          location: "Qudos Bank Arena, Sydney, Australia",
          dateFull: "Sunday, October 5, 2025",
          ticketStatus: "sold-out",
          ticketUrl: "#",
        },
        {
          day: "12",
          month: "Oct",
          title: "Arctic Monkeys in Brisbane",
          location: "Brisbane Entertainment Centre, Brisbane, Australia",
          dateFull: "Sunday, October 12, 2025",
          ticketStatus: "sold-out",
          ticketUrl: "#",
        },
        {
          day: "20",
          month: "Oct",
          title: "Arctic Monkeys in Perth",
          location: "RAC Arena, Perth, Australia",
          dateFull: "Monday, October 20, 2025",
          ticketStatus: "sold-out",
          ticketUrl: null,
        },
        {
          day: "28",
          month: "Oct",
          title: "Arctic Monkeys in Auckland",
          location: "Spark Arena, Auckland, New Zealand",
          dateFull: "Tuesday, October 28, 2025",
          ticketStatus: "sold-out",
          ticketUrl: "#",
        },
      ],
    },
    {
      month: "November 2025",
      events: [
        {
          day: "05",
          month: "Nov",
          title: "Arctic Monkeys in Cape Town",
          location: "Grand Arena, Cape Town, South Africa",
          dateFull: "Wednesday, November 5, 2025",
          ticketStatus: "sold-out",
          ticketUrl: "#",
        },
        {
          day: "12",
          month: "Nov",
          title: "Arctic Monkeys in Johannesburg",
          location: "FNB Stadium, Johannesburg, South Africa",
          dateFull: "Wednesday, November 12, 2025",
          ticketStatus: "available",
          ticketUrl: "#",
        },
        {
          day: "20",
          month: "Nov",
          title: "Arctic Monkeys in Dubai",
          location: "Coca-Cola Arena, Dubai, UAE",
          dateFull: "Thursday, November 20, 2025",
          ticketStatus: "sold-out",
          ticketUrl: null,
        },
        {
          day: "28",
          month: "Nov",
          title: "Arctic Monkeys in Tel Aviv",
          location: "Menora Mivtachim Arena, Tel Aviv, Israel",
          dateFull: "Friday, November 28, 2025",
          ticketStatus: "available",
          ticketUrl: "#",
        },
      ],
    },
    {
      month: "December 2025",
      events: [
        {
          day: "05",
          month: "Dec",
          title: "Arctic Monkeys in Istanbul",
          location: "Vodafone Park, Istanbul, Turkey",
          dateFull: "Friday, December 5, 2025",
          ticketStatus: "available",
          ticketUrl: "#",
        },
        {
          day: "12",
          month: "Dec",
          title: "Arctic Monkeys in Athens",
          location: "OAKA Olympic Indoor Hall, Athens, Greece",
          dateFull: "Friday, December 12, 2025",
          ticketStatus: "no-tickets",
          ticketUrl: "#",
        },
        {
          day: "20",
          month: "Dec",
          title: "Arctic Monkeys in Lisbon",
          location: "Altice Arena, Lisbon, Portugal",
          dateFull: "Saturday, December 20, 2025",
          ticketStatus: "sold-out",
          ticketUrl: null,
        },
        {
          day: "31",
          month: "Dec",
          title: "Arctic Monkeys New Year's Eve Special",
          location: "O2 Arena, London, United Kingdom",
          dateFull: "Wednesday, December 31, 2025",
          ticketStatus: "available",
          ticketUrl: "#",
        },
      ],
    },
    {
      month: "January 2026",
      events: [
        {
          day: "15",
          month: "Jan",
          title: "Arctic Monkeys in Moscow",
          location: "VTB Arena, Moscow, Russia",
          dateFull: "Thursday, January 15, 2026",
          ticketStatus: "available",
          ticketUrl: "#",
        },
        {
          day: "22",
          month: "Jan",
          title: "Arctic Monkeys in St. Petersburg",
          location: "Ice Palace, St. Petersburg, Russia",
          dateFull: "Thursday, January 22, 2026",
          ticketStatus: "available",
          ticketUrl: "#",
        },
        {
          day: "30",
          month: "Jan",
          title: "Arctic Monkeys in Helsinki",
          location: "Hartwall Arena, Helsinki, Finland",
          dateFull: "Friday, January 30, 2026",
          ticketStatus: "sold-out",
          ticketUrl: null,
        },
      ],
    },
    {
      month: "February 2026",
      events: [
        {
          day: "08",
          month: "Feb",
          title: "Arctic Monkeys in Riga",
          location: "Arena Riga, Riga, Latvia",
          dateFull: "Sunday, February 8, 2026",
          ticketStatus: "available",
          ticketUrl: "#",
        },
        {
          day: "15",
          month: "Feb",
          title: "Arctic Monkeys in Tallinn",
          location: "Saku Suurhall, Tallinn, Estonia",
          dateFull: "Sunday, February 15, 2026",
          ticketStatus: "no-tickets",
          ticketUrl: "#",
        },
        {
          day: "22",
          month: "Feb",
          title: "Arctic Monkeys in Vilnius",
          location: "Avia Solutions Group Arena, Vilnius, Lithuania",
          dateFull: "Sunday, February 22, 2026",
          ticketStatus: "no-tickets",
          ticketUrl: null,
        },
      ],
    },
    {
      month: "March 2026",
      events: [
        {
          day: "05",
          month: "Mar",
          title: "Arctic Monkeys in Budapest",
          location: "Papp László Budapest Sportaréna, Budapest, Hungary",
          dateFull: "Thursday, March 5, 2026",
          ticketStatus: "no-tickets",
          ticketUrl: "#",
        },
        {
          day: "12",
          month: "Mar",
          title: "Arctic Monkeys in Bucharest",
          location: "Sala Polivalentă, Bucharest, Romania",
          dateFull: "Thursday, March 12, 2026",
          ticketStatus: "no-tickets",
          ticketUrl: "#",
        },
        {
          day: "20",
          month: "Mar",
          title: "Arctic Monkeys in Sofia",
          location: "Arena Armeec, Sofia, Bulgaria",
          dateFull: "Friday, March 20, 2026",
          ticketStatus: "no-tickets",
          ticketUrl: null,
        },
        {
          day: "28",
          month: "Mar",
          title: "Arctic Monkeys in Zagreb",
          location: "Arena Zagreb, Zagreb, Croatia",
          dateFull: "Saturday, March 28, 2026",
          ticketStatus: "no-tickets",
          ticketUrl: "#",
        },
      ],
    },
    {
      month: "April 2026",
      events: [
        {
          day: "05",
          month: "Apr",
          title: "Arctic Monkeys in Belgrade",
          location: "Štark Arena, Belgrade, Serbia",
          dateFull: "Sunday, April 5, 2026",
          ticketStatus: "no-tickets",
          ticketUrl: "#",
        },
        {
          day: "12",
          month: "Apr",
          title: "Arctic Monkeys in Ljubljana",
          location: "Arena Stožice, Ljubljana, Slovenia",
          dateFull: "Sunday, April 12, 2026",
          ticketStatus: "no-tickets",
          ticketUrl: "#",
        },
        {
          day: "20",
          month: "Apr",
          title: "Arctic Monkeys in Bratislava",
          location: "Ondrej Nepela Arena, Bratislava, Slovakia",
          dateFull: "Monday, April 20, 2026",
          ticketStatus: "no-tickets",
          ticketUrl: null,
        },
        {
          day: "28",
          month: "Apr",
          title: "Arctic Monkeys in Krakow",
          location: "Tauron Arena, Krakow, Poland",
          dateFull: "Tuesday, April 28, 2026",
          ticketStatus: "no-tickets",
          ticketUrl: "#",
        },
      ],
    },
  ],
};

// Function to create event card HTML
function createEventCard(event) {
  let ticketButton = "";

  switch (event.ticketStatus) {
    case "available":
      ticketButton = `<button class="ticket-btn" onclick="openTicketModal('${event.title}', '${event.location}', '${event.dateFull}', '${event.month}')">Get Tickets</button>`;
      break;
    case "sold-out":
      ticketButton = `<span class="ticket-btn sold-out">Sold Out</span>`;
      break;
    case "no-tickets":
      ticketButton = `<span class="ticket-btn no-link">No tickets available</span>`;
      break;
    default:
      ticketButton = `<span class="ticket-btn">Tickets TBA</span>`;
  }

  return `
    <div class="event-card">
      <div class="event-info">
        <div class="event-date">
          <span class="day">${event.day}</span>
          <span class="month">${event.month}</span>
        </div>
        <div class="event-details">
          <h4 class="event-title">${event.title}</h4>
          <p class="event-location">${event.location}</p>
          <p class="event-date-full">${event.dateFull}</p>
        </div>
      </div>
      <div class="event-actions">
        ${ticketButton}
      </div>
    </div>
  `;
}

// Function to create month group HTML
function createMonthGroup(monthData) {
  const eventsHtml = monthData.events
    .map((event) => createEventCard(event))
    .join("");

  return `
    <details class="events-month-group">
      <summary class="month-header">
        <h3>${monthData.month}</h3>
        <span class="toggle-icon">+</span>
      </summary>
      <div class="month-events">
        ${eventsHtml}
      </div>
    </details>
  `;
}

// Function to render all events
function renderEvents() {
  const eventsList = document.querySelector(".events-list");
  if (eventsList) {
    eventsList.innerHTML = toursData.events
      .map((monthData) => createMonthGroup(monthData))
      .join("");
  }
}

// Function to initialize the page
function initializeToursPage() {
  renderEvents();
}

// Ticket Modal and Cart Integration
function openTicketModal(title, location, dateFull, month) {
  // Create modal HTML
  const modalHTML = `
    <div class="ticket-modal-overlay" id="ticket-modal">
      <div class="ticket-modal">
        <div class="ticket-modal-header">
          <h3>Purchase Tickets</h3>
          <button class="ticket-modal-close" onclick="closeTicketModal()">&times;</button>
        </div>
        <div class="ticket-modal-content">
          <div class="event-details">
            <h4>${title}</h4>
            <p class="event-location">${location}</p>
            <p class="event-date">${dateFull}</p>
          </div>
          <div class="ticket-options">
            <h5>Select Ticket Type:</h5>
            <div class="ticket-type" data-type="general" data-price="45.00">
              <div class="ticket-info">
                <h6>General Admission</h6>
                <p>Standing area access</p>
              </div>
              <div class="ticket-price">$45.00</div>
            </div>
            <div class="ticket-type" data-type="vip" data-price="85.00">
              <div class="ticket-info">
                <h6>VIP Package</h6>
                <p>Priority entry, exclusive area, merchandise</p>
              </div>
              <div class="ticket-price">$85.00</div>
            </div>
            <div class="ticket-type" data-type="premium" data-price="125.00">
              <div class="ticket-info">
                <h6>Premium Experience</h6>
                <p>Best seats, meet & greet, signed merchandise</p>
              </div>
              <div class="ticket-price">$125.00</div>
            </div>
          </div>
          <div class="ticket-quantity">
            <label for="ticket-qty">Quantity:</label>
            <select id="ticket-qty">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
            </select>
          </div>
          <div class="ticket-actions">
            <button class="btn-secondary" onclick="closeTicketModal()">Cancel</button>
            <button class="btn-primary" onclick="addTicketToCart()">Add to Cart</button>
          </div>
        </div>
      </div>
    </div>
  `;

  // Add modal to page
  document.body.insertAdjacentHTML("beforeend", modalHTML);

  // Add event listeners for ticket type selection
  const ticketTypes = document.querySelectorAll(".ticket-type");
  ticketTypes.forEach((type) => {
    type.addEventListener("click", function () {
      ticketTypes.forEach((t) => t.classList.remove("selected"));
      this.classList.add("selected");
    });
  });

  // Select first ticket type by default
  if (ticketTypes.length > 0) {
    ticketTypes[0].classList.add("selected");
  }
}

function closeTicketModal() {
  const modal = document.getElementById("ticket-modal");
  if (modal) {
    modal.remove();
  }
}

function addTicketToCart() {
  const selectedTicket = document.querySelector(".ticket-type.selected");
  const quantity = parseInt(document.getElementById("ticket-qty").value);

  if (!selectedTicket) {
    alert("Please select a ticket type");
    return;
  }

  const ticketType = selectedTicket.dataset.type;
  const price = parseFloat(selectedTicket.dataset.price);
  const eventTitle = document.querySelector(".event-details h4").textContent;
  const eventLocation = document.querySelector(".event-location").textContent;
  const eventDate = document.querySelector(".event-date").textContent;

  // Create ticket product
  const ticketProduct = {
    id: `ticket-${Date.now()}`,
    name: `${eventTitle} - ${
      ticketType.charAt(0).toUpperCase() + ticketType.slice(1)
    } Ticket`,
    category: "tickets",
    price: price,
    image: "https://i.ebayimg.com/images/g/aWIAAOSwqRRm4YFq/s-l1200.png",
    description: `${eventLocation} - ${eventDate}`,
    inStock: true,
    stock: 999,
    eventTitle: eventTitle,
    eventLocation: eventLocation,
    eventDate: eventDate,
    ticketType: ticketType,
  };

  // Add to cart if cart exists
  if (typeof cart !== "undefined" && cart.addItem) {
    cart.addItem(ticketProduct, quantity);
    closeTicketModal();
    showNotification("Tickets added to cart!", "success");

    setTimeout(() => {
      window.location.href = "./checkout.html";
    }, 1500);
  } else {
    alert("Cart system not available. Please try again.");
  }
}

function showNotification(message, type = "info") {
  const notification = document.createElement("div");
  notification.className = `notification notification-${type}`;
  notification.textContent = message;

  // Add styles
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: ${type === "success" ? "#28a745" : "#007bff"};
    color: white;
    padding: 15px 20px;
    border-radius: 5px;
    z-index: 10000;
    animation: slideInRight 0.3s ease;
  `;

  document.body.appendChild(notification);

  setTimeout(() => {
    notification.remove();
  }, 3000);
}

// Initialize when DOM is loaded
document.addEventListener("DOMContentLoaded", initializeToursPage);
